---
title: "FLAME: A small language model for spreadsheet formulas"
authors: "H. Joshi, A. Ebenezer, J. Cambronero, S. Gulwani, A. Kanade, V. Le, I. Radicek, G. Verbruggen"
venue: "AAAI 2024"
publishedAt: "2024-01-11"
summary: "We proposeâ€¦"
pdf: "/papers/flame.pdf"
arxiv: https://arxiv.org/abs/2301.13779
media: https://www.theregister.com/2023/02/04/microsoft_excel_ai/
link: https://www.microsoft.com/en-us/research/publication/flame-a-small-language-model-for-spreadsheet-formulas/
selected: "True"
---
Spreadsheets are a vital tool for end-user data management. Using large language models for formula authoring assistance in these environments can be difficult, as these models are expensive to train and challenging to deploy due to their size (up to billions of parameters). We present FLAME, a transformer-based model trained exclusively on Excel formulas that leverages domain insights to achieve competitive performance while being substantially smaller (60M parameters) and training on two orders of magnitude less data. We curate a training dataset using sketch deduplication, introduce an Excel-specific formula tokenizer, and use domain-specific versions of masked span prediction and noisy auto-encoding as pre-training objectives. We evaluate FLAME on formula repair, formula completion, and similarity-based formula retrieval. FLAME can outperform much larger models, such as the Davinci (175B) and Cushman (12B) variants of Codex and CodeT5 (220M), in 10 of 14 evaluation settings for the repair and completion tasks. For formula retrieval, FLAME outperforms CodeT5, CodeBERT, and GraphCodeBERT.